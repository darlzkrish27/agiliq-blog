<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta charset="utf-8"> 
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="manjunath" />
        <meta name="copyright" content="manjunath" />

        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="google, markdown, " />

<meta property="og:title" content="Google diff match patch library "/>
<meta property="og:url" content="/google-diff-match-patch-library.html" />
<meta property="og:description" content="Google&#39;s diff match patch library is very simple to use." />
<meta property="og:site_name" content="agiliq_blog" />
<meta property="og:article:author" content="manjunath" />
<meta property="og:article:published_time" content="2014-05-09T05:59:34+05:30" />
<meta property="" content="2014-05-09T16:29:34+05:30" />
<meta name="twitter:title" content="Google diff match patch library ">
<meta name="twitter:description" content="Google&#39;s diff match patch library is very simple to use.">

        <title>Google diff match patch library  Â· agiliq_blog
</title>
        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
        <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.1/css/font-awesome.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="/theme/css/pygments.css" media="screen">
        <link rel="stylesheet" type="text/css" href="/theme/tipuesearch/tipuesearch.css" media="screen">
        <link rel="stylesheet" type="text/css" href="/theme/css/elegant.css" media="screen">
        <link rel="stylesheet" type="text/css" href="/theme/css/custom.css" media="screen">
    </head>
    <body>
        <div id="content-sans-footer">
        <div class="navbar navbar-static-top">
            <div class="navbar-inner">
                <div class="container-fluid">
                    <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </a>
                    <a class="brand" href="/"><span class=site-name>agiliq_blog</span></a>
                    <div class="nav-collapse collapse">
                        <ul class="nav pull-right top-menu">
                            <li ><a href="">Home</a></li>
                            <li ><a href="/categories.html">Categories</a></li>
                            <li ><a href="/tags.html">Tags</a></li>
                            <li ><a href="/archives.html">Archives</a></li>
                            <li><form class="navbar-search" action="/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="container-fluid">
            <div class="row-fluid">
                <div class="span1"></div>
                <div class="span10">
<article>
<div class="row-fluid">
    <header class="page-header span10 offset2">
    <h1><a href="/google-diff-match-patch-library.html"> Google diff match patch library  </a></h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">

            
            <p>Diff match patch library is useful to compare the differences between the two texts.It compares the texts and displays what is added, removed or unchanged.</p>
<p>We use <code>Python</code> in our example below.</p>
<h4>Let us see a quick example</h4>
<p>Firstly, we will install diff match patch</p>
<div class="highlight"><pre><span></span>pip install diff-match-patch
</pre></div>


<p>Moving forward we will import diff_match_patch</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">diff_match_patch</span>
</pre></div>


<p>Let us consider using two strings, we will name it as <code>old_string</code> and <code>new_string</code></p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">diff_match_patch</span>

<span class="n">old_string</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;I&#39;m selfish, impatient and a little insecure. I make mistakes,</span>
<span class="s2">I am out of control and at times hard to handle. But if you can&#39;t handle me at my worst,</span>
<span class="s2">then you sure as hell don&#39;t deserve me at my best.&quot;&quot;&quot;</span>

<span class="n">new_string</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;I&#39;m selfish, impatient and a little secure. I don&#39;t make mistakes,</span>
<span class="s2">I am out of control and at times hard to handle difficult things. But if you can&#39;t handle me at my worst,</span>
<span class="s2">then you sure as hell don&#39;t deserve me at my best.&quot;&quot;&quot;</span>
</pre></div>


<p>Now, we will create an object of <code>diff_match_patch</code> and call <code>diff_main(old_string, new_string)</code></p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">diff_match_patch</span>

<span class="n">old_string</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;I&#39;m selfish, impatient and a little insecure. I make mistakes,</span>
<span class="s2">I am out of control and at times hard to handle. But if you can&#39;t handle me at my worst,</span>
<span class="s2">then you sure as hell don&#39;t deserve me at my best.&quot;&quot;&quot;</span>

<span class="n">new_string</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;I&#39;m selfish, impatient and a little secure. I don&#39;t make mistakes,</span>
<span class="s2">I am out of control and at times hard to handle difficult things. But if you can&#39;t handle me at my worst,</span>
<span class="s2">then you sure as hell don&#39;t deserve me at my best.&quot;&quot;&quot;</span>

<span class="n">diff_obj</span> <span class="o">=</span> <span class="n">diff_match_patch</span><span class="o">.</span><span class="n">diff_match_patch</span><span class="p">()</span>
<span class="n">diffs</span> <span class="o">=</span> <span class="n">diff_obj</span><span class="o">.</span><span class="n">diff_main</span><span class="p">(</span><span class="n">old_string</span><span class="p">,</span> <span class="n">new_string</span><span class="p">)</span>
</pre></div>


<h4>What <code>diff_main(text1, text2)</code> does?</h4>
<p>It computes an array of differences to describe the transformation of text1 into text2.
For Example in the above code <code>diffs</code> contains an array of tuples.</p>
<p>We will see what this tuple contains, before that let us make this array Human readable.</p>
<p><code>diff_match_patch</code> has a method <code>diff_cleanupSemantic(diffs)</code> which does the job for us.</p>
<div class="highlight"><pre><span></span>diff_obj.diff_cleanupSemantic(diffs)
</pre></div>


<p>Now variable <code>diffs</code> contains</p>
<p><code>[(0, "I'm selfish, impatient and a little "),
 (-1, 'in'),
 (0, 'secure. I '),
 (1, "don't "),
 (0, 'make mistakes,\nI am out of control and at times hard to handle'),
 (1, ' difficult things'),
 (0, ". But if you can't handle me at my worst,\nthen you sure as hell don't deserve me at my best.")]</code></p>
<p>Now it looks better, let us see what these tuples contains:</p>
<ul>
<li>The first element specifies if it is an insertion (1), a deletion (-1) or an equality (0).</li>
<li>The second element specifies the affected text. </li>
</ul>
<p>To convert these array of tuples to HTML.We use <code>diff_prettyHtml(diffs)</code>.</p>
<div class="highlight"><pre><span></span>html = diff_obj.diff_prettyHtml(diffs)
</pre></div>


<p>There you are, we can now see the differences in old and new text.</p>
<p><strong> <span>I\'m selfish, impatient and a little </span><del style="background:#ffe6e6;">in</del><span>secure. I </span><ins style="background:#e6ffe6;">don\'t </ins> <br>
<span>make mistakes,&para;<br>I am out of control and at times hard to handle</span><ins style="background:#e6ffe6;"> difficult things</ins><span>. But if you can\'t
handle me at my worst,&para;<br>then you sure as hell don\'t deserve me at my best.</span> </strong></p>
<p>But the above html is not so clear to understand what is added and removed right?</p>
<p>We will write a method to see these changes side by side.</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">diff_match_patch</span>

<span class="n">old_string</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;I&#39;m selfish, impatient and a little insecure. I make mistakes,</span>
<span class="s2">I am out of control and at times hard to handle. But if you can&#39;t handle me at my worst,</span>
<span class="s2">then you sure as hell don&#39;t deserve me at my best.&quot;&quot;&quot;</span>

<span class="n">new_string</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;I&#39;m selfish, impatient and a little secure. I don&#39;t make mistakes,</span>
<span class="s2">I am out of control and at times hard to handle difficult things. But if you can&#39;t handle me at my worst,</span>
<span class="s2">then you sure as hell don&#39;t deserve me at my best.&quot;&quot;&quot;</span>

<span class="k">class</span> <span class="nc">SideBySideDiff</span><span class="p">(</span><span class="n">diff_match_patch</span><span class="o">.</span><span class="n">diff_match_patch</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">old_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">diffs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns HTML representation of &#39;deletions&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">html</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span> <span class="ow">in</span> <span class="n">diffs</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&amp;&quot;</span><span class="p">,</span> <span class="s2">&quot;&amp;amp;&quot;</span><span class="p">)</span>
                    <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&lt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&amp;lt;&quot;</span><span class="p">)</span>
                    <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&amp;gt;&quot;</span><span class="p">)</span>
                    <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;br&gt;&quot;</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">flag</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">DIFF_DELETE</span><span class="p">:</span>
                <span class="n">html</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;&lt;del style=</span><span class="se">\&quot;</span><span class="s2">background:#ffe6e6;</span>
<span class="s2">                    </span><span class="se">\&quot;</span><span class="s2">&gt;</span><span class="si">%s</span><span class="s2">&lt;/del&gt;&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">text</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">flag</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">DIFF_EQUAL</span><span class="p">:</span>
                <span class="n">html</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&lt;span&gt;</span><span class="si">%s</span><span class="s2">&lt;/span&gt;&quot;</span> <span class="o">%</span> <span class="n">text</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">new_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">diffs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns HTML representation of &#39;insertions&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">html</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span> <span class="ow">in</span> <span class="n">diffs</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&amp;&quot;</span><span class="p">,</span> <span class="s2">&quot;&amp;amp;&quot;</span><span class="p">)</span>
                    <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&lt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&amp;lt;&quot;</span><span class="p">)</span>
                    <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&amp;gt;&quot;</span><span class="p">)</span>
                    <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;br&gt;&quot;</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">flag</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">DIFF_INSERT</span><span class="p">:</span>
                <span class="n">html</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;&lt;ins style=</span><span class="se">\&quot;</span><span class="s2">background:#e6ffe6;</span>
<span class="s2">                    </span><span class="se">\&quot;</span><span class="s2">&gt;</span><span class="si">%s</span><span class="s2">&lt;/ins&gt;&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">text</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">flag</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">DIFF_EQUAL</span><span class="p">:</span>
                <span class="n">html</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&lt;span&gt;</span><span class="si">%s</span><span class="s2">&lt;/span&gt;&quot;</span> <span class="o">%</span> <span class="n">text</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>


<span class="n">diff_obj</span> <span class="o">=</span> <span class="n">SideBySideDiff</span><span class="p">()</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">diff_obj</span><span class="o">.</span><span class="n">diff_main</span><span class="p">(</span><span class="n">old_string</span><span class="p">,</span> <span class="n">new_string</span><span class="p">)</span>
<span class="n">diff_obj</span><span class="o">.</span><span class="n">diff_cleanupSemantic</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="n">old_record</span> <span class="o">=</span> <span class="n">diff_obj</span><span class="o">.</span><span class="n">old_content</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> 
<span class="n">new_record</span> <span class="o">=</span> <span class="n">diff_obj</span><span class="o">.</span><span class="n">new_content</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>


<p>Here is the output for the above code:</p>
<div style="margin-left: 5%; float: left; width: 45%; overflow: auto; display: block; background-color: #fff;<br />}">
<p>
<h2>Old record</h2>

<span>I'm selfish, impatient and a little </span><del style="background:#ffe6e6;">in</del><span>secure. I </span><span>make mistakes,<br>I am out of control and at times hard to handle</span><span>. But if you can't handle me at my worst,<br>then you sure as hell don't deserve me at my best.</span>

</p>

</div>

<div style="margin-left: 5%; float: left; width: 45%; overflow: auto; display: block; background-color: #fff;<br />}">
<p>
<h2>New record</h2>
<span>I'm selfish, impatient and a little </span><span>secure. I </span><ins style="background:#e6ffe6;">don't </ins><span>make mistakes,<br>I am out of control and at times hard to handle</span><ins style="background:#e6ffe6;"> difficult things</ins><span>. But if you can't handle me at my worst,<br>then you sure as hell don't deserve me at my best.</span>

</p>
</div>

<p>For reference and some more methods see <a href="http://code.google.com/p/google-diff-match-patch/wiki/API">API</a></p>
<p>Feedbacks and suggestions are welcome :)</p>
<p>e :)</p>
            
            
            <hr/>
        </div>
        <section>
        <div class="span2" style="float:right;font-size:0.9em;">
            <h4>Published</h4>
            <time pubdate="pubdate" datetime="2014-05-09T05:59:34+05:30">May 9, 2014</time>

<h4>Last Updated</h4>
<time datetime="2014-05-09T16:29:34+05:30">May 9, 2014</time>

            <h4>Category</h4>
            <a class="category-link" href="/categories.html#markdown-ref">markdown</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="/tags.html#google-ref">google
                    <span>2</span>
</a></li>
            </ul>
<h4>Contact</h4>
    <a href="#" title="My You can add links in your config file Profile" class="sidebar-social-links" target="_blank">
    <i class="fa fa-you can add links in your config file sidebar-social-links"></i></a>
    <a href="#" title="My Another social link Profile" class="sidebar-social-links" target="_blank">
    <i class="fa fa-another social link sidebar-social-links"></i></a>
        </div>
        </section>
</div>
</article>
                </div>
                <div class="span1"></div>
            </div>
        </div>
        <div id="push"></div>
    </div>
<footer>
<div id="footer">
    <ul class="footer-content">
        <li class="elegant-power">Powered by <a href="http://getpelican.com/" title="Pelican Home Page">Pelican</a>. Theme: <a href="http://oncrashreboot.com/pelican-elegant" title="Theme Elegant Home Page">Elegant</a> by <a href="http://oncrashreboot.com" title="Talha Mansoor Home Page">Talha Mansoor</a></li>
    </ul>
</div>
</footer>            <script src="http://code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    
    </body>
    <!-- Theme: Elegant built for Pelican
    License : http://oncrashreboot.com/pelican-elegant -->
</html>